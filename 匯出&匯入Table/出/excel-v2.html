<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>excel v2</title>
</head>

<body>
  <table class="table tableStyles" id="tables">
    <caption>不正經的統計表</caption>
    <!--可以生成表格的標題-->
    <thead>
      <tr>
        <th>品牌</th>
        <th>門店</th>
        <th>本週回訪</th>
        <th>本月回訪</th>
        <th>總回訪</th>
        <th>本週成交數</th>
        <th>本月成交數</th>
        <th>總成交數</th>
        <th>異常量</th>
        <th>成交轉化率</th>
        <th>經手人</th>
      </tr>
    </thead>
    <tbody align="right">
      <tr>
        <th rowspan="3">華為</th>
        <td>華為深圳店</td>
        <td>20</td>
        <td>80</td>
        <td>500</td>
        <td>1</td>
        <td>3</td>
        <td>20</td>
        <td>1</td>
        <td>4.0%</td>
        <td>黃生</td>
      </tr>
      <tr>
        <td>華為東莞店</td>
        <td>20</td>
        <td>80</td>
        <td>500</td>
        <td>1</td>
        <td>3</td>
        <td>20</td>
        <td>1</td>
        <td>4.0%</td>
        <td>黃生</td>
      </tr>
      <tr>
        <td>華為佛山店</td>
        <td>20</td>
        <td>80</td>
        <td>500</td>
        <td>1</td>
        <td>3</td>
        <td>20</td>
        <td>1</td>
        <td>4.0%</td>
        <td>黃生</td>
      </tr>
      <tr>
        <th rowspan="2">小米</th>
        <td>米家深圳店</td>
        <td>20</td>
        <td>80</td>
        <td>500</td>
        <td>1</td>
        <td>3</td>
        <td>20</td>
        <td>1</td>
        <td>4.0%</td>
        <td>林生</td>
      </tr>
      <tr>
          <td>米家無名店</td>
          <td>20</td>
          <td>80</td>
          <td>500</td>
          <td>1</td>
          <td>3</td>
          <td>20</td>
          <td>1</td>
          <td>4.0%</td>
          <td>林生</td>
        </tr>
    </tbody>
  </table>
  <a id="dlink" style="display:none;"></a>
  <input type="button" onclick="tableToExcel('tables', 'name', '不正經.xls')" value="Export to Excel">

  <script>
    var tableToExcel = (function () {
      var uri = 'data:application/vnd.ms-excel;base64,',
        template =
        '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
        base64 = function (s) {
          return window.btoa(unescape(encodeURIComponent(s)))
        },
        format = function (s, c) {
          return s.replace(/{(\w+)}/g, function (m, p) {
            return c[p];
          })
        };
      return function (table, name, filename) {
        if (!table.nodeType) table = document.getElementById(table)
        var ctx = {
          worksheet: name || 'Worksheet',
          table: table.innerHTML
        }

        document.getElementById("dlink").href = uri + base64(format(template, ctx));
        document.getElementById("dlink").download = filename;
        document.getElementById("dlink").click();
      }
    })()
  </script>
</body>

</html>